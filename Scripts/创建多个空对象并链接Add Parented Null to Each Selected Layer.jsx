// Add Parented Null to Each Selected Layer.jsx// ©July 2009  Lloyd Alvarez  http://aescripts.com////   Creates a new parented Null for every one of the selected layers.//  You can define what the Suffix name for the null layer is in the user variables below.//  If you want to include the layer name in the Adj Layer set the variable to 1.//  To not include the layer name set the variable to 0.// *****Note that in CS3 and below After Effects has a 31 character limit for layer names so the name of the//  Null will be truncated to the first 31 characters ********//  CS4 does not have a character limit for layers.//	//////////////////////////////////////////////////////////////////////////             USER VARIABLES://var nullSuffix = "-Null";var addLayerNameBeforeSuffix = 1;  // 1 for yes, 0 for no//////////////////////////////////////////////////////////////////////////var proj = app.project;	var undoStr = "Add Parented Null to Selected Layers";	if (proj){		var myComp = app.project.activeItem;		if (myComp != null && (myComp instanceof CompItem)){			app.beginUndoGroup(undoStr);						var myLayers = myComp.selectedLayers;			var saveIn = 0;			var saveOut = 0;			for (i=0; i <= myLayers.length-1; i++){								currentLayer = myLayers[i];				saveIn = (currentLayer.stretch < 0) ? currentLayer.outPoint : currentLayer.inPoint;				saveOut = (currentLayer.stretch < 0) ? currentLayer.inPoint : currentLayer.outPoint;				saveIndex = currentLayer.index;				saveName = (addLayerNameBeforeSuffix) ? currentLayer.name+nullSuffix : nullSuffix;								var myName = (parseFloat(app.version) < 8.0) ? saveName.substring(0, 31) : saveName;				var newNull = myComp.layers.addNull(myComp.duration);								newNull.moveBefore(myLayers[i]);				newNull.inPoint = saveIn				newNull.outPoint = saveOut;				(currentLayer.threeDLayer) ? newNull.threeDLayer  = true : newNull.threeDLayer  = false;				currentLayer.parent = newNull;				newNull.name = myName;				}						app.endUndoGroup();		} else {			alert("Please select an active comp to use this script");		}	}	else	{		alert("Please open a project first to use this script.");	}